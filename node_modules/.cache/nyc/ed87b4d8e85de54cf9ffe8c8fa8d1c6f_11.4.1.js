var cov_2e12l01xmw=function(){var path='/home/bwilbur/projects/mercury/modules/communication/controllers/communication-controller.js',hash='38abc6bf8214999603e488aabfe4825a7f5434bc',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/bwilbur/projects/mercury/modules/communication/controllers/communication-controller.js',statementMap:{'0':{start:{line:1,column:27},end:{line:1,column:75}},'1':{start:{line:2,column:17},end:{line:2,column:59}},'2':{start:{line:3,column:15},end:{line:3,column:59}},'3':{start:{line:9,column:29},end:{line:9,column:53}},'4':{start:{line:10,column:2},end:{line:15,column:5}},'5':{start:{line:11,column:3},end:{line:11,column:57}},'6':{start:{line:13,column:3},end:{line:13,column:24}},'7':{start:{line:14,column:3},end:{line:14,column:62}},'8':{start:{line:20,column:15},end:{line:20,column:30}},'9':{start:{line:21,column:2},end:{line:24,column:3}},'10':{start:{line:23,column:3},end:{line:23,column:68}},'11':{start:{line:26,column:2},end:{line:26,column:39}},'12':{start:{line:28,column:29},end:{line:28,column:53}},'13':{start:{line:29,column:2},end:{line:34,column:5}},'14':{start:{line:30,column:3},end:{line:30,column:58}},'15':{start:{line:32,column:3},end:{line:32,column:24}},'16':{start:{line:33,column:3},end:{line:33,column:80}},'17':{start:{line:39,column:17},end:{line:39,column:34}},'18':{start:{line:40,column:2},end:{line:43,column:3}},'19':{start:{line:42,column:3},end:{line:42,column:76}},'20':{start:{line:45,column:15},end:{line:45,column:30}},'21':{start:{line:46,column:2},end:{line:49,column:3}},'22':{start:{line:48,column:3},end:{line:48,column:72}},'23':{start:{line:51,column:2},end:{line:51,column:39}},'24':{start:{line:53,column:29},end:{line:53,column:53}},'25':{start:{line:54,column:2},end:{line:59,column:5}},'26':{start:{line:55,column:3},end:{line:55,column:37}},'27':{start:{line:57,column:3},end:{line:57,column:24}},'28':{start:{line:58,column:3},end:{line:58,column:80}},'29':{start:{line:64,column:17},end:{line:64,column:35}},'30':{start:{line:65,column:2},end:{line:68,column:3}},'31':{start:{line:67,column:3},end:{line:67,column:78}},'32':{start:{line:70,column:29},end:{line:70,column:53}},'33':{start:{line:71,column:2},end:{line:76,column:5}},'34':{start:{line:72,column:3},end:{line:72,column:37}},'35':{start:{line:74,column:3},end:{line:74,column:24}},'36':{start:{line:75,column:3},end:{line:75,column:62}},'37':{start:{line:80,column:0},end:{line:80,column:41}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:7,column:1},end:{line:7,column:2}},loc:{start:{line:8,column:1},end:{line:16,column:2}},line:8},'1':{name:'(anonymous_1)',decl:{start:{line:10,column:36},end:{line:10,column:37}},loc:{start:{line:10,column:47},end:{line:12,column:3}},line:10},'2':{name:'(anonymous_2)',decl:{start:{line:12,column:11},end:{line:12,column:12}},loc:{start:{line:12,column:20},end:{line:15,column:3}},line:12},'3':{name:'(anonymous_3)',decl:{start:{line:18,column:1},end:{line:18,column:2}},loc:{start:{line:19,column:1},end:{line:35,column:2}},line:19},'4':{name:'(anonymous_4)',decl:{start:{line:29,column:44},end:{line:29,column:45}},loc:{start:{line:29,column:57},end:{line:31,column:3}},line:29},'5':{name:'(anonymous_5)',decl:{start:{line:31,column:11},end:{line:31,column:12}},loc:{start:{line:31,column:20},end:{line:34,column:3}},line:31},'6':{name:'(anonymous_6)',decl:{start:{line:37,column:1},end:{line:37,column:2}},loc:{start:{line:38,column:1},end:{line:60,column:2}},line:38},'7':{name:'(anonymous_7)',decl:{start:{line:54,column:55},end:{line:54,column:56}},loc:{start:{line:54,column:61},end:{line:56,column:3}},line:54},'8':{name:'(anonymous_8)',decl:{start:{line:56,column:11},end:{line:56,column:12}},loc:{start:{line:56,column:20},end:{line:59,column:3}},line:56},'9':{name:'(anonymous_9)',decl:{start:{line:62,column:1},end:{line:62,column:2}},loc:{start:{line:63,column:1},end:{line:77,column:2}},line:63},'10':{name:'(anonymous_10)',decl:{start:{line:71,column:49},end:{line:71,column:50}},loc:{start:{line:71,column:55},end:{line:73,column:3}},line:71},'11':{name:'(anonymous_11)',decl:{start:{line:73,column:11},end:{line:73,column:12}},loc:{start:{line:73,column:20},end:{line:76,column:3}},line:73}},branchMap:{'0':{loc:{start:{line:21,column:2},end:{line:24,column:3}},type:'if',locations:[{start:{line:21,column:2},end:{line:24,column:3}},{start:{line:21,column:2},end:{line:24,column:3}}],line:21},'1':{loc:{start:{line:40,column:2},end:{line:43,column:3}},type:'if',locations:[{start:{line:40,column:2},end:{line:43,column:3}},{start:{line:40,column:2},end:{line:43,column:3}}],line:40},'2':{loc:{start:{line:46,column:2},end:{line:49,column:3}},type:'if',locations:[{start:{line:46,column:2},end:{line:49,column:3}},{start:{line:46,column:2},end:{line:49,column:3}}],line:46},'3':{loc:{start:{line:65,column:2},end:{line:68,column:3}},type:'if',locations:[{start:{line:65,column:2},end:{line:68,column:3}},{start:{line:65,column:2},end:{line:68,column:3}}],line:65}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const DomainWhitelistDao=(cov_2e12l01xmw.s[0]++,require('./../models/mail/domain-whitelist-dao'));const Response=(cov_2e12l01xmw.s[1]++,require('./../../utility/models/response'));const config=(cov_2e12l01xmw.s[2]++,require('./../../../config/config').instance);class CommunicationController{loadAll(req,res){cov_2e12l01xmw.f[0]++;const domainWhitelistDao=(cov_2e12l01xmw.s[3]++,new DomainWhitelistDao());cov_2e12l01xmw.s[4]++;domainWhitelistDao.loadAll().then(domains=>{cov_2e12l01xmw.f[1]++;cov_2e12l01xmw.s[5]++;return new Response(res,200,'',{domains:domains});}).catch(error=>{cov_2e12l01xmw.f[2]++;cov_2e12l01xmw.s[6]++;console.error(error);cov_2e12l01xmw.s[7]++;return new Response(res,500,config.app.messages.default);});}addDomain(req,res){cov_2e12l01xmw.f[3]++;let domain=(cov_2e12l01xmw.s[8]++,req.body.domain);cov_2e12l01xmw.s[9]++;if(!domain){cov_2e12l01xmw.b[0][0]++;cov_2e12l01xmw.s[10]++;return new Response(res,400,'','Must provide a valid domain');}else{cov_2e12l01xmw.b[0][1]++;}cov_2e12l01xmw.s[11]++;domain=domain.trim().toLowerCase();const domainWhitelistDao=(cov_2e12l01xmw.s[12]++,new DomainWhitelistDao());cov_2e12l01xmw.s[13]++;domainWhitelistDao.addDomain(domain).then(newDomain=>{cov_2e12l01xmw.f[4]++;cov_2e12l01xmw.s[14]++;return new Response(res,200,'',{domain:newDomain});}).catch(error=>{cov_2e12l01xmw.f[5]++;cov_2e12l01xmw.s[15]++;console.error(error);cov_2e12l01xmw.s[16]++;return new Response(res,400,'','This domain is already on the whitelist');});}editDomain(req,res){cov_2e12l01xmw.f[6]++;let domainId=(cov_2e12l01xmw.s[17]++,req.body.domainId);cov_2e12l01xmw.s[18]++;if(!domainId){cov_2e12l01xmw.b[1][0]++;cov_2e12l01xmw.s[19]++;return new Response(res,400,'','Must provide a valid domain to edit');}else{cov_2e12l01xmw.b[1][1]++;}let domain=(cov_2e12l01xmw.s[20]++,req.body.domain);cov_2e12l01xmw.s[21]++;if(!domain){cov_2e12l01xmw.b[2][0]++;cov_2e12l01xmw.s[22]++;return new Response(res,400,'','Must provide a valid new domain');}else{cov_2e12l01xmw.b[2][1]++;}cov_2e12l01xmw.s[23]++;domain=domain.trim().toLowerCase();const domainWhitelistDao=(cov_2e12l01xmw.s[24]++,new DomainWhitelistDao());cov_2e12l01xmw.s[25]++;domainWhitelistDao.editDomain(domainId,domain).then(()=>{cov_2e12l01xmw.f[7]++;cov_2e12l01xmw.s[26]++;return new Response(res,200,'');}).catch(error=>{cov_2e12l01xmw.f[8]++;cov_2e12l01xmw.s[27]++;console.error(error);cov_2e12l01xmw.s[28]++;return new Response(res,400,'','This domain is already on the whitelist');});}removeDomain(req,res){cov_2e12l01xmw.f[9]++;let domainId=(cov_2e12l01xmw.s[29]++,req.query.domainId);cov_2e12l01xmw.s[30]++;if(!domainId){cov_2e12l01xmw.b[3][0]++;cov_2e12l01xmw.s[31]++;return new Response(res,400,'','Must provide a valid domain to remove');}else{cov_2e12l01xmw.b[3][1]++;}const domainWhitelistDao=(cov_2e12l01xmw.s[32]++,new DomainWhitelistDao());cov_2e12l01xmw.s[33]++;domainWhitelistDao.removeDomain(domainId).then(()=>{cov_2e12l01xmw.f[10]++;cov_2e12l01xmw.s[34]++;return new Response(res,200,'');}).catch(error=>{cov_2e12l01xmw.f[11]++;cov_2e12l01xmw.s[35]++;console.error(error);cov_2e12l01xmw.s[36]++;return new Response(res,500,config.app.messages.default);});}}cov_2e12l01xmw.s[37]++;module.exports=CommunicationController;